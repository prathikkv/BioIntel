# üöÄ BioIntel.AI Production Deployment Guide

## Prerequisites

1. **Vercel Account**: Sign up at https://vercel.com
2. **Supabase Account**: Sign up at https://supabase.com
3. **Upstash Account**: Sign up at https://upstash.com (for Redis)

## Step 1: Set Up Database (Supabase)

1. Create a new project at https://supabase.com/dashboard
2. Go to Settings ‚Üí Database
3. Copy the connection string (URI format)
4. Update `DATABASE_URL` in your environment variables

## Step 2: Set Up Redis (Upstash)

1. Create a new Redis database at https://console.upstash.com/redis
2. Select the free tier
3. Copy the Redis URL
4. Update `REDIS_URL` in your environment variables

## Step 3: Deploy to Vercel

### 3.1 Install Vercel CLI and Login
```bash
npm install -g vercel
vercel login
```

### 3.2 Set Environment Variables
```bash
# Set production secrets (generated by generate_secrets.py)
vercel env add SECRET_KEY production
vercel env add JWT_SECRET_KEY production
vercel env add FERNET_KEY production

# Set database URLs
vercel env add DATABASE_URL production
vercel env add REDIS_URL production

# Set CORS origins (replace with your domain)
vercel env add CORS_ORIGINS production
```

### 3.3 Deploy
```bash
vercel --prod
```

## Step 4: Initialize Production Database

After deployment, run the database setup:
```bash
# Update DATABASE_URL in .env with your Supabase URL
python3 setup_production_db.py
```

## Step 5: Test Deployment

### 5.1 Health Check
```bash
curl https://your-app.vercel.app/health
```

Expected response:
```json
{
  "status": "healthy",
  "timestamp": 1234567890,
  "version": "1.0.0",
  "environment": "production",
  "database": "connected",
  "features": {
    "machine_learning": false,
    "plotting": false,
    "ai_processing": false,
    "pdf_generation": false,
    "docx_generation": false
  }
}
```

### 5.2 API Documentation
Visit: `https://your-app.vercel.app/docs`

### 5.3 Test Key Endpoints
```bash
# Test root endpoint
curl https://your-app.vercel.app/

# Test user registration
curl -X POST https://your-app.vercel.app/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "email": "test@example.com",
    "password": "testpass123",
    "full_name": "Test User",
    "organization": "Test Org",
    "consent_given": true
  }'
```

## Production Optimizations

### Features Available in Production:
‚úÖ **Core API endpoints**
‚úÖ **User authentication**
‚úÖ **File upload/processing**
‚úÖ **Database operations**
‚úÖ **Basic data analysis**
‚úÖ **PDF text extraction**
‚úÖ **Literature processing**
‚úÖ **Report generation (HTML)**

### Features Disabled (Due to Size Constraints):
‚ùå **Advanced ML (scikit-learn)**
‚ùå **Data visualization (matplotlib/plotly)**
‚ùå **AI/NLP (transformers)**
‚ùå **PDF generation (WeasyPrint)**
‚ùå **DOCX generation**

### Performance Considerations:
- **Function timeout**: 30 seconds
- **Memory limit**: 1GB
- **Cold start**: ~2-3 seconds
- **Package size**: <250MB

## Monitoring & Logs

### View Logs
```bash
vercel logs your-app.vercel.app
```

### Monitor Performance
- Visit Vercel dashboard for analytics
- Health check endpoint: `/health`
- API documentation: `/docs`

## Security Checklist

‚úÖ **Strong secrets generated**
‚úÖ **Database connection encrypted**
‚úÖ **CORS configured**
‚úÖ **Rate limiting enabled**
‚úÖ **Input validation**
‚úÖ **JWT authentication**
‚úÖ **Password hashing**

## Troubleshooting

### Common Issues:

1. **Database connection failed**
   - Check DATABASE_URL format
   - Verify Supabase project is active
   - Ensure connection string includes password

2. **Function timeout**
   - Check logs for slow queries
   - Verify database connection pooling
   - Monitor function execution time

3. **Package size exceeded**
   - Verify using `requirements-vercel.txt`
   - Check for large dependencies
   - Use `vercel inspect` to analyze bundle

4. **CORS errors**
   - Update CORS_ORIGINS environment variable
   - Add your domain to allowed origins
   - Check frontend domain configuration

## Support

For issues or questions:
1. Check Vercel deployment logs
2. Review health check endpoint
3. Verify environment variables
4. Test database connectivity

## Next Steps

1. **Custom Domain**: Add your domain in Vercel dashboard
2. **SSL Certificate**: Automatic with Vercel
3. **CDN**: Automatic with Vercel
4. **Monitoring**: Set up alerts for health checks
5. **Backup**: Configure database backups in Supabase